<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ISS Database</title>
<style>
body {font-family:sans-serif;background:#0a0e27;color:#e8eaf6;padding:20px;}
header {display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
header a {color:#10b981;text-decoration:none;}
table {width:100%;border-collapse:collapse;}
th,td {padding:8px;text-align:center;border:1px solid rgba(102,126,234,0.3);}
th {background: rgba(102,126,234,0.1);}
tbody tr:nth-child(even){background:rgba(102,126,234,0.05);}
#daySelector {margin-left:10px;padding:5px;border-radius:4px;}
</style>
</head>
<body>
<header>
  <h1>ISS Database Records</h1>
  <div>
    <a href="/">← Back to Dashboard</a>
    <label for="daySelector">Select Day:</label>
    <select id="daySelector">
      <option value="0">Day 1 (Today)</option>
      <option value="1">Day 2 (Yesterday)</option>
      <option value="2">Day 3</option>
    </select>
  </div>
</header>

<table id="issTable">
  <thead>
    <tr>
      <th>Date (UTC)</th>
      <th>Timestamp (UTC)</th>
      <th>Latitude (°)</th>
      <th>Longitude (°)</th>
      <th>Altitude (km)</th>
      <th>Velocity (km/h)</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="6">Loading...</td></tr>
  </tbody>
</table>

<script>
async function loadData(dayIndex){
  try {
    const res = await fetch(`/api/preview?day_index=${dayIndex}`);
    const json = await res.json();
    const tbody = document.querySelector('#issTable tbody');
    tbody.innerHTML = '';
    if(!json.records || json.records.length === 0){
      tbody.innerHTML = '<tr><td colspan="6">No data available.</td></tr>';
      return;
    }
    json.records.forEach(r=>{
      const tr = document.createElement('tr');
      const dateStr = new Date(r.timestamp*1000).toISOString().split('T')[0]; // YYYY-MM-DD
      tr.innerHTML = `
        <td>${dateStr}</td>
        <td>${r.ts_utc}</td>
        <td>${r.latitude.toFixed(4)}</td>
        <td>${r.longitude.toFixed(4)}</td>
        <td>${r.altitude.toFixed(2)}</td>
        <td>${r.velocity.toFixed(2)}</td>
      `;
      tbody.appendChild(tr);
    });
  } catch(err){ console.error(err); }
}

// Day selector
const daySelector = document.getElementById('daySelector');
daySelector.onchange = ()=>{ loadData(daySelector.value); };

// Initial load
loadData(0);
</script>
</body>
</html>
